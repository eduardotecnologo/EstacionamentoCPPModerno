/* TicketEstacionamentoLogicoRelacional: */


CREATE TABLE USUARIO (
    USU_MAI VARCHAR(40) NOT NULL,
    USU_SEN VARCHAR(12) NOT NULL,
    USU_NOM VARCHAR(20) NOT NULL,
    CONSTRAINT PK_USUARIO PRIMARY KEY(USU_MAI)
);

CREATE TABLE VEICULO (
    VEI_COD INTEGER NOT NULL,
    MON_COD INTEGER NOT NULL,
    MOD_COD INTEGER NOT NULL,
    TIP_COD INTEGER NOT NULL,
    VEI_PLA VARCHAR(12),
    VEI_ANO_FAB INTEGER,
    CONSTRAINT PK_VEICULO PRIMARY KEY(VEI_COD)
);

CREATE TABLE CONDUTOR (
    CON_COD INTEGER NOT NULL,
    CON_NOM VARCHAR(60) NOT NULL,
    CON_CNH VARCHAR(15),
    CON_CPF CHAR(14) NOT NULL,
    CONSTRAINT PK_CONDUTOR PRIMARY KEY(CON_COD)
);

CREATE TABLE CONDUCAO (
    CND_COD INTEGER NOT NULL,
    CON_COD INTEGER,
    VEI_COD INTEGER NOT NULL,
    CONSTRAINT PK_CONDUCAO PRIMARY KEY(CND_COD)
);

CREATE TABLE MONTADORA (
    MON_COD INTEGER NOT NULL,
    MON_NOM VARCHAR(60) NOT NULL,
    CONSTRAINT PK_MONTADORA PRIMARY KEY(MON_COD)
);

CREATE TABLE MODELO (
    MOD_COD INTEGER NOT NULL,
    MON_COD INTEGER NOT NULL,
    MOD_NOM VARCHAR(60) NOT NULL,
    CONSTRAINT PK_MODELO PRIMARY KEY(MOD_COD)
);

CREATE TABLE TICKET (
    TIC_NUM INTEGER NOT NULL,
    CND_COD INTEGER NOT NULL,
    TIC_DAT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    TIC_HOR_ENT TIMESTAMP  DEFAULT CURRENT_TIMESTAMP,
    TIC_HOR_SAI TIMESTAMP,
    TIC_VAL_PAG NUMERIC(15,4),
    CONSTRAINT PK_TICKET PRIMARY KEY(TIC_NUM)
);

CREATE TABLE TIPO (
    TIP_COD INTEGER NOT NULL,
    TIP_DES VARCHAR(20) NOT NULL,
    CONSTRAINT PK_TIPO PRIMARY KEY(TIP_COD)
);
 
ALTER TABLE VEICULO ADD CONSTRAINT FK_MONTADORA_VEICULO
    FOREIGN KEY (MON_COD)
    REFERENCES MONTADORA(MON_COD)ON UPDATE CASCADE;


ALTER TABLE VEICULO ADD CONSTRAINT FK_MODELO_VEICULO
    FOREIGN KEY (MOD_COD)
    REFERENCES MODELO(MOD_COD)ON UPDATE CASCADE;


ALTER TABLE VEICULO ADD CONSTRAINT FK_TIPO_VEICULO
    FOREIGN KEY (TIP_COD)
    REFERENCES TIPO (TIP_COD) ON UPDATE CASCADE;

 
ALTER TABLE CONDUCAO ADD CONSTRAINT FK_VEICULO_CONDUCAO
    FOREIGN KEY (VEI_COD)
    REFERENCES VEICULO (VEI_COD) ON UPDATE CASCADE;

ALTER TABLE CONDUCAO ADD CONSTRAINT FK_CONDUTOR_CONDUCAO
    FOREIGN KEY (CON_COD)
    REFERENCES CONDUTOR(CON_COD) ON UPDATE CASCADE ON DELETE SET NULL;

 
ALTER TABLE MODELO ADD CONSTRAINT FK_MONTADORA_MODELO
    FOREIGN KEY (MON_COD)
    REFERENCES MONTADORA (MON_COD)ON UPDATE CASCADE;
 
ALTER TABLE TICKET ADD CONSTRAINT FK_CONDUCAO_TICKET
    FOREIGN KEY (CND_COD)
    REFERENCES CONDUCAO(CND_COD) ON UPDATE CASCADE;